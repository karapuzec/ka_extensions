{% set is_section_started = false %}

{% for f in fields %}
	{% if f.section %}
	
		{% if is_section_started %}
			</fieldset>
		{% endif %}
		
    <fieldset>
      <legend>{{ f.section }}</legend>
    {% set is_section_started = true %}
  {% endif %}
	
	{% if f.type %}
		{{ include('/default/template/extension/ka_extensions/common/fields/' ~ f.type ~ '.twig', {'field': f }, ignore_missing = true) }}
	{% else %}
		{% include '/default/template/extension/ka_extensions/common/fields/text.twig' with {'field': f } %}
	{% endif %}						

	{% block process_field %}{% endblock %}
	
{% endfor %}
